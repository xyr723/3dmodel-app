# 3D模型应用前端API集成文档

## 概述

前端已成功适配后端API接口，支持以下功能：

### ✅ 已适配的功能

1. **搜索3D模型** - POST/GET `/sketchfab/search`
2. **获取模型详情** - GET `/sketchfab/model/{model_uid}`
3. **下载3D模型** - POST/GET `/sketchfab/download`
4. **获取热门模型** - GET `/sketchfab/popular`
5. **获取分类列表** - GET `/sketchfab/categories`

## 配置说明

### 环境变量配置

请在项目根目录创建 `.env` 文件：

```bash
# 后端API基础URL
VITE_BACKEND_BASE_URL=http://localhost:8000/api

# 后端API密钥 (请联系后端管理员获取)
VITE_BACKEND_API_KEY=your_api_key_here
```

### 认证方式

前端使用 `Authorization: Bearer` 请求头进行认证，匹配后端API要求。

## 主要改动

### 1. TypeScript类型更新

- 更新了 `SketchfabLicense` 类型以匹配后端支持的许可证
- 添加了 `SketchfabCategoriesResponse` 类型
- 调整了可选字段以匹配API响应结构

### 2. API客户端更新

- 所有请求使用 `Authorization: Bearer` 认证头
- 更新分类获取函数以处理后端返回的字符串数组
- 移除了搜索响应中的 `filters_applied` 字段

### 3. 组件增强

- **SketchfabBrowser**: 自动加载真实分类数据，更新许可证选项
- **SketchfabPage**: 添加模型下载功能，增强模型详情显示
- **模型卡片**: 显示更多信息如许可证、评论数、可下载状态

### 4. 新增功能

- **模型下载**: 点击下载按钮通过API获取下载链接
- **分类加载**: 从后端动态加载分类列表
- **许可证显示**: 直观显示模型许可证信息
- **更丰富的模型信息**: 显示评论数、许可证状态等

## 使用说明

### 开发模式

如果没有设置 `VITE_BACKEND_API_KEY`，应用将：

1. 使用模拟数据进行开发
2. 显示默认分类列表
3. 搜索返回空结果

### 生产模式

配置正确的API密钥后，应用将：

1. 连接真实的后端API
2. 从后端加载分类数据
3. 支持完整的搜索、浏览、下载功能

## API集成测试

要测试API集成：

1. 确保后端服务运行在 `http://localhost:8000`
2. 获取有效的API密钥
3. 配置环境变量
4. 启动前端应用：`npm run dev`
5. 访问 Sketchfab 页面测试各项功能

## 错误处理

应用包含完善的错误处理：

- 网络请求失败时显示错误消息
- API密钥无效时回退到模拟数据
- 分类加载失败时使用默认分类
- 下载失败时显示详细错误信息

## 注意事项

1. 确保后端API正确实现了文档中描述的接口
2. API密钥需要妥善保管，不要提交到版本控制
3. 下载功能依赖浏览器支持，大文件下载可能需要时间
4. 搜索结果会被缓存1小时，分类数据缓存24小时

## 许可证合规

应用会显示模型的许可证信息，提醒用户：

- 下载前检查许可证要求
- 商业使用前确认许可证条款
- 需要署名的模型会特别标注

## 性能优化

- 使用缓存减少重复API调用
- 搜索请求去重避免并发重复请求
- 模型列表采用虚拟滚动（如需处理大量数据）
- 图片懒加载优化页面性能
